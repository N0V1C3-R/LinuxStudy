# Linux进程管理  
---
## 1. Linux进程
+ 基本介绍  
  1. 在Linux中，每个执行的程序都称为一个进程。每一个进程都分配一个ID号（pid，进程号）  
  2. 每个进程都可能以两种方式存在：前台与后台。所谓前台进程就是用户目前屏幕上可以进行操作的，后台进程则是实际在操作的，但由于屏幕上无法看到，通常使用后台方式执行  
  3. 一般系统的服务都是以后台进程的方式存在，而且会常驻在系统中，直到关机才结束
+ 基本语法  
  `ps`命令是用来查看目前系统中有哪些正在执行，以及它们执行的状况
+ 常用选项  
  *-a*：显示当前终端的所有进程信息  
  *-u*：以用户的格式显示进程信息  
  *-x*：显示后台进程运行的参数  
  *-e*：显示所有进程  
  *-f*：全格式
+ ps详解
  1. 指令`ps -aux | grep xxx`  
       + System V展示风格  
       + *USER*用户名称    
       + *PID*进程ID   
       + *%CPU*进程站CPU的百分比  
       + *%MEM*进程占用的物理内存百分比  
       + *VSZ*进程占用的虚拟内存大小（单位KB）  
       + *RSS*进程占用的物理内存大小（单位KB）  
       + *TT*终端名称，缩写  
       + *STAT*进程状态，其中*s-*表示该进程是会话的先导进程，*N-*表示进程拥有比普通优先级更低的优先级，*R-*正在运行，*D-*短期等待，*Z-*僵死进程，*T-*被跟踪或者被停止等等  
       + *STARTED*进程的启动时间  
       + *TIME*CPU时间，即进程使用CPU的总时间  
       + *COMMAND*启动进程所用的命令和参数，如果过长会被截断显示  
  2. 指令`ps -ef | grep xxx`  
       + BSD展示风格  
       + *UID*用户ID  
       + *PID*进程ID  
       + *PPID*父进程ID  
       + *C*CPU用于计算执行优先级的因子，数值越大，表明进程是CPU密集型运算，执行优先级会降低；数组越小，表明是I/O密集型运算，执行优先级会提高  
       + *STIME*进程启动的时间  
       + *TTY*终端名称  
       + *TIME*CPU时间，即进程使用CPU的总时间  
       + *COMMAND*启动进程所用的命令和参数，如果过长会被截断显示
---
## 2. 终止进程  
+ 基本介绍  
  若是某个进程执行到一般需要停止时，或是已消耗了很大的系统资源时，此时可以考虑停止该进程。使用`kill`命令来完成此项任务  
+ 基本语法  
  `kill [选项] 进程号`&emsp;通过进程号杀死进程  
  `killall 进程名称`&emsp;通过进程名杀死进程，也支持通配符，在系统因负责过大而变得很慢时效果显著  
+ 常用选项  
  *-9*：表示强迫进程立即停止
---
## 3. 查看进程数
+ 基本语法
  `pstree [选项]`&emsp;可以更直观的查看进程信息
+ 常用进程  
  *-p*:显示进程PID  
  *-u*：显示进程的所属用户
---
## 4. 服务管理
+ 基本介绍
  服务（service）本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他进程的请求，比如MySQL、SSHD、防火墙等，因此我们又称其为守护进程，是Linux中非常重要的知识点
+ service管理指令
  1. `service 服务名 [start | stop | restart | reload | status]`
  2. 在CentOS7.0以后，**很多服务不再使用service**，而是**systemctl**  
  3. service指令管理的服务在 */etc/init.d* 查看`ls -l /etc/init.d`
+ 查看服务名
  使用`setup`选择系统服务  
---
## 5. 服务的运行级别  
+ Linux系统有7种运行级别（runlevel）：**常用级别3和5**  
  1. 运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动  
  2. 运行级别1：单用户工作状态，有root权限，用于系统维护，静止远程登录  
  3. 运行级别2：多用户工作状态（没有NFS），不支持网络  
  4. 运行级别3：完全的多用户状态（有NFS），登录后进入控制台命令模式  
  5. 运行级别4：系统未使用，保留  
  6. 运行级别5：X11控制台，登录后进入图形GUI模式  
  7. 运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动  
+ 开机的流程说明
  开机 ==> BIOS ==> /boot ==> system进程 ==> 运行级别 ==> 运行级别对应的服务
+ chkconfig指令
  + 基本介绍  
    1. 通过 chkconfig 命令可以给服务的各个运行级别设置自启动/关闭  
    2. chkconfig 指令管理的服务在 */etc/init.d* 查看  
    3. 注意：CentOS7.0以后，很多服务使用**systemctl**管理
  + 基本语法  
    + 查看服务`chkconfig --list [| grep xxx]`  
    + `chkconfig 服务名 --list`  
    + `chkconfig --level 5 服务名 on/off`
---
## 6. systemctl管理指令
+ 基本介绍  
  在CentOS7.0以后，很多服务的管理指令已经由原来的指令变为了systemctl指令，systenctl指令管理的服务在 */usr/lib/systemd/system* 查看  
+ 基本语法  
  `systemctl [start | stop | restart | status] 服务名`  
+ systemctl设置服务的自启动管理  
  1. `systemctl list-unit-files [| grep 服务名]`&emsp;查看服务开机启动的状态  
  2. `systemctl enable 服务名`&emsp;设置服务开机启动  
  3. `systemctl disable 服务名`&emsp;关闭服务开机启动  
  4. `systemctl is-enable 服务名`&emsp;查询某个服务是否是自启动的
---
## 7. 防火墙firewall
+ 基本介绍  
  所谓防火墙指的是一个由软件和硬件设备组合而成、在内部网和外部网之间、专用网与公共网之间的界面上构造的保护屏障。在真正的生产环境中，往往需要将防火墙打开，但由于防火墙打开以后，外部请求数据包就不能跟服务器监听端口进行通讯，这时就需要打开指定端口  
+ 基本指令  
  `firewall-cmd --permanent --add-port=端口号/协议`&emsp;打开端口（永久）  
  `firewall-cmd --permanent --remove-port=端口号/协议`&emsp;关闭端口  
  `firewall-cmd --reload`&emsp;重新载入  
  `firewall-cmd --query-port=端口号/协议`&emsp;查询端口是否开启  
---
## 8. 动态监控进程  
+ 基本介绍  
  top与ps命令很相似，它们都是用来显示正在执行的进程。top与ps最大的不同之处在于：top执行一段时间可以更新正在运行的进程  
+ 基本语法  
  `top [选项]`
+ 选项说明  
  *-d <秒>*：指定top命令每隔几秒更新一次，默认是3秒  
  *-i*：使top不显示任何闲置或者僵死的进程  
  *-p*：通过指定监控进程ID来监控某个进程的状态
+ 交互操作
  *P*：以CPU使用率排序  
  *M*：以内存使用率排序  
  *N*：以PID排序  
  *u <用户名>*：监听指定用户  
  *k <进程ID>*：杀死指定进程  
  *q*：退出top  
---
## 9. 监控网络状态  
+ 基本语法
  `netstat [选项]`
+ 选项说明  
  *-an*：按一定顺序排列输出  
  *-p*：显示正在调用的进程  